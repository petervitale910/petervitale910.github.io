{
  "hash": "019930fb4a27aa46bfc1a71f22005720",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"San Fransisco Bay Catch Dynamics\"\ndescription: \"Examining Northern Anchovies ability to predict indicator species\"\ndate: 2025-12-3\ncategories: [MEDS, R, Statistics]\ncitation: \n  url: https://petervitale910.github.io/\ncode-fold: true\n---\n tktktktkt\n \n tktktktk\n### DAG\n\n\n### Import packages\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load('tidyverse', 'here', 'janitor', 'indicspecies', 'MASS', 'ggthemes')\n```\n:::\n\n\n### Import and clean data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Raw catch data\ncatch_raw <- read_csv(here::here('posts', 'sf_bay_catches', 'data', 'catch_9218.csv'))\n\n# For easy reference we also import species key \nspecies_key <- read_csv(here::here('posts', 'sf_bay_catches','data', 'species_key.csv'), col_names = FALSE)\n```\n:::\n\nNow we can clean up the messy dataset and make a functional species key \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# The species key has some very difficult first columns so we need to restrict it down to just species code and name\nspecies_key_clean <- species_key[c(4,5),3:125] %>% \n  row_to_names(row_number = 1) %>% \n  clean_names() %>% \n  remove_empty(which = \"rows\") %>% \n  pivot_longer(cols = everything(),names_to = 'species_code', values_to = 'species_name')%>% \n  mutate(species_code = str_to_upper(species_code),\n                                     species_name = str_to_title(str_to_lower(species_name)))\n\nspecies_key_clean\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 123 × 2\n   species_code species_name          \n   <chr>        <chr>                 \n 1 AG           Arrow Goby            \n 2 AS           American Shad         \n 3 BBC          Brown Bullhead Catfish\n 4 BG           Bay Goby              \n 5 BHS          Bonyhead Sculpin      \n 6 BOC          Bocaccio Rockfish     \n 7 BP           Black Perch           \n 8 BPF          Bay Pipefish          \n 9 BR           Bat Ray               \n10 BRF          Bolinas Rockfish      \n# ℹ 113 more rows\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# The catch data is much cleaner, all we need is a quick clean names\ncatch_clean <- catch_raw %>% \n  clean_names()\n\ncatch_clean$species_code[is.na(catch_clean$species_code)] <- 'NA'\n\nhead(catch_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 37\n  catch_info_trawl_id species_code  size class number sex   trawl_map_trawl_id\n                <dbl> <chr>        <dbl> <dbl>  <dbl> <chr>              <dbl>\n1                  10 SSP              0    NA      1 <NA>                  10\n2                  10 SSP             90    NA      1 <NA>                  10\n3                  10 SSP             56    NA      1 <NA>                  10\n4                  10 NA              NA    NA     15 <NA>                  10\n5                  10 CH              NA    NA      4 <NA>                  10\n6                  10 BS             480    NA      1 F                     10\n# ℹ 30 more variables: locale <chr>, trawl_map_training_trawl <lgl>,\n#   trawl_map_data_audit <lgl>, expr1 <dbl>, expr2 <dbl>,\n#   trawl_info_trawl_id <dbl>, hydro_id <dbl>, scientists <chr>, intern <chr>,\n#   date <chr>, school <chr>, trawl_time_begin <dbl>, trawl_time_end <dbl>,\n#   trawl_time_total <dbl>, depth_of_trawl <dbl>, tidal_current <chr>,\n#   last_slack_time <dbl>, last_slack_tide <chr>, last_slack_height <dbl>,\n#   sample_station <chr>, water_type <chr>, substrate <chr>, …\n```\n\n\n:::\n:::\n\n### Preliminary analysis: Top Species\n\nWe want to display the top 10 species caught by quantity\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_10_catch <- catch_clean %>%\n  left_join(species_key_clean,\n            by = \"species_code\") %>%\n  group_by(species_name) %>%\n  summarise(total_catch = sum(number, na.rm = TRUE)) %>%\n  arrange(desc(total_catch)) %>%\n  slice_head(n = 10) \n\ntop_10_catch\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n   species_name        total_catch\n   <chr>                     <dbl>\n 1 Northern Anchovy         640618\n 2 Shiner Surfperch         128489\n 3 English Sole              84714\n 4 Staghorn Sculpin          27409\n 5 Pacific Herring           25755\n 6 Speckled Sanddab          15305\n 7 California Halibut        14069\n 8 Plainfin Midshipman       13662\n 9 Sanddab Sp.               13231\n10 White Croaker             11443\n```\n\n\n:::\n:::\n\nIn this analysis we will take the most abundant species, Northern Anchovy, and comparing it with indicator species from the different regions of the bay. \n\n### Preliminary analysis: Indicator species\n\nIndicator species does tktktktkt. It takes a group *vector* and a species *matrix*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindicator <- catch_clean %>% \n  dplyr::select(catch_info_trawl_id, species_code, number, locale) %>% \n  pivot_wider(names_from = species_code, values_from = number, values_fn = sum) %>% \n  mutate(across(where(is.numeric), ~replace_na(., 0))) %>% \n  filter(!locale == 'BLANK')\n\ngroup_vector <- indicator$locale\n\nspecies_matrix <- as.matrix(indicator[, -c(1, 2)])\n```\n:::\n\n\nNow we can run the function indval to find indicator species values for our groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindval <- multipatt(species_matrix, group_vector, \n                    control = how(nperm=999)) \n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n summary <- summary(indval, alpha = .1) # Alpha is significance threshold \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Multilevel pattern analysis\n ---------------------------\n\n Association function: IndVal.g\n Significance level (alpha): 0.1\n\n Total number of species: 162\n Selected number of species: 50 \n Number of species associated to 1 group: 33 \n Number of species associated to 2 groups: 12 \n Number of species associated to 3 groups: 5 \n\n List of species associated to each combination: \n\n Group CENTRAL BAY  #sps.  13 \n     stat p.value   \nSSD 0.456   0.006 **\nCLF 0.217   0.042 * \nPOM 0.110   0.031 * \nps  0.066   0.053 . \nHH  0.065   0.067 . \nCRL 0.065   0.082 . \nOP  0.059   0.043 * \nJM  0.059   0.035 * \nBSC 0.050   0.044 * \nes  0.046   0.096 . \nIRL 0.042   0.027 * \nssd 0.042   0.031 * \nSTR 0.029   0.086 . \n\n Group SAN PABLO BAY  #sps.  4 \n     stat p.value  \nBR  0.449   0.011 *\nDT  0.328   0.040 *\nTS  0.277   0.012 *\nBSK 0.214   0.050 *\n\n Group SOUTH BAY  #sps.  2 \n     stat p.value  \nCT  0.308   0.052 .\nDSP 0.285   0.092 .\n\n Group SUISUN BAY  #sps.  14 \n     stat p.value    \nSB  0.880   0.001 ***\nSF  0.768   0.001 ***\nTFS 0.417   0.001 ***\nSST 0.303   0.001 ***\nDLS 0.204   0.006 ** \nBDG 0.204   0.005 ** \nTP  0.148   0.014 *  \nCC  0.129   0.003 ** \nBLP 0.129   0.003 ** \nCK  0.091   0.015 *  \nKS  0.091   0.019 *  \nDS  0.089   0.021 *  \nBBC 0.088   0.021 *  \nPL  0.086   0.054 .  \n\n Group CENTRAL BAY+SAN PABLO BAY  #sps.  6 \n     stat p.value    \nPMS 0.652   0.001 ***\nPH  0.535   0.003 ** \nBG  0.495   0.001 ***\nBPF 0.338   0.014 *  \nWSP 0.320   0.017 *  \nBHS 0.225   0.094 .  \n\n Group CENTRAL BAY+SOUTH BAY  #sps.  1 \n    stat p.value  \nSD 0.381   0.031 *\n\n Group CENTRAL BAY+SUISUN BAY  #sps.  1 \n    stat p.value  \nPS 0.267   0.043 *\n\n Group SAN PABLO BAY+SOUTH BAY  #sps.  1 \n    stat p.value  \nBS 0.343   0.052 .\n\n Group SAN PABLO BAY+SUISUN BAY  #sps.  2 \n     stat p.value    \nYG  0.574   0.002 ** \nLFS 0.538   0.001 ***\n\n Group SOUTH BAY+SUISUN BAY  #sps.  1 \n   stat p.value  \nUG 0.32   0.075 .\n\n Group CENTRAL BAY+SAN PABLO BAY+SOUTH BAY  #sps.  3 \n     stat p.value   \nNA  0.811   0.002 **\nSSP 0.762   0.002 **\nWC  0.385   0.045 * \n\n Group CENTRAL BAY+SAN PABLO BAY+SUISUN BAY  #sps.  1 \n     stat p.value    \nPSD 0.527   0.001 ***\n\n Group SAN PABLO BAY+SOUTH BAY+SUISUN BAY  #sps.  1 \n    stat p.value  \nLS 0.353   0.042 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n```\n\n\n:::\n:::\n\nFrom the summary we can see that the top species for the four San Francisco Bay locales are: \n\nGroup CENTRAL BAY  \nSSD: Speckled Sanddab\n\nGroup SAN PABLO BAY  \nBR: Bat Ray   \n\nGroup SOUTH BAY  \nCT: California Tonguefish  \n\nGroup SUISUN BAY  \nSB: Striped Bass    \n\n\nNext we are going to compare Northern Anchovy catches to these species using a hurdle model\n\n### Hurdle model and create function \n\nThe hurdle model does tktktktk\n\nBecause we are running and fitting this model four times, it sounds like I should make it into a function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#' predict indicator\n#'\n#' @param df\n#' Data frame used for analysis\n#' @param sp_code \n#' Species code (wrapped in '')\n#' @param region \n#' Locale (all capitals wrapped in '')\n#' @returns\n#' a list containing: \n#' stage1_summary \n#' stage2_summary \n#' stage1_pred \n#' stage2_pred\n#' combined_pred \n#' plot \n#' @export\n#'\n#' @examples\npredict_indicator <- function(df, sp_code, region){\n\nspecies_name <- species_key_clean %>% \n  filter(species_code == sp_code) %>% \n  pull(species_name) %>% \n  make_clean_names()\n  \n\n\ncatch_plot <- df %>% \n  filter(species_code == 'NA' | species_code == sp_code) %>% \n  mutate(in_region = ifelse(locale == region, TRUE, FALSE)) %>% \n  group_by(species_code, catch_info_trawl_id, in_region) %>% \n  summarize(count = sum(number)) %>% \n  pivot_wider(names_from = species_code,\n              values_from = count) %>% \n  set_names(c('trawl_id', 'in_region', 'northern_anchovy', species_name)) \n\ncatch_plot[is.na(catch_plot)] <- 0\n\na <- mean(catch_plot$northern_anchovy)\nb <- sd(catch_plot$northern_anchovy)\n\ncatch_plot <- catch_plot %>% \n  mutate(northern_anchovy_z = (northern_anchovy - a) / b,\n         presence = ifelse(.data[[species_name]] > 0, 1, 0),\n         abundance = ifelse(.data[[species_name]] > 0, .data[[species_name]], NA))\n\n\nm1 <- glm(presence ~ northern_anchovy_z * in_region, data = catch_plot, family = binomial(link = 'logit'))\n\nm2 <- glm.nb(abundance ~ northern_anchovy_z * in_region, data = catch_plot)\n\nsum_m1 <- summary(m1)\n\nsum_m2 <- summary(m2)\n\ngrid_data <- expand_grid(in_region = c(TRUE, FALSE),\n  northern_anchovy_z = seq(min(catch_plot$northern_anchovy_z), max(catch_plot$northern_anchovy_z), by = 1))\n\npredict_pres <-  predict(m1,\n                      newdata = grid_data,\n                      type = \"link\",\n                      se.fit = TRUE)\n\npredict_abu <-  predict(m2,\n                      newdata = grid_data,\n                      type = \"link\",\n                      se.fit = TRUE)\n\npred_pres_result <- grid_data %>% \n  mutate(\n    fit_link = predict_pres$fit,\n    se = predict_pres$se.fit,\n    pred_tbs = plogis(fit_link),\n    lower = plogis(fit_link - 1.96*se),\n    upper = plogis(fit_link + 1.96*se)\n  )\n\npred_abu_result <- grid_data %>% \n  mutate(\n    fit_link = predict_abu$fit,\n    se = predict_abu$se.fit,\n    pred_tbs = exp(fit_link),\n    lower = exp(fit_link - 1.96*se),\n    upper = exp(fit_link + 1.96*se)\n  )\n\n# Merge predictions \ncombined <- pred_pres_result %>% \n  mutate(\n    expected_count = pred_tbs * pred_abu_result$pred_tbs,\n    lower_expected = lower * pred_abu_result$lower,\n    upper_expected = upper * pred_abu_result$upper\n  )\n\nplot <- ggplot(combined, aes(northern_anchovy_z, expected_count))+\n  facet_wrap(~in_region,\n             labeller = as_labeller(\n      c(`TRUE` = \"In Region\", `FALSE` = \"Outside Region\")\n    ))+\n  geom_line(color = '#A0185A')+\n  geom_ribbon(aes(ymin = lower_expected, ymax = upper_expected),\n              alpha = .3, fill = '#ABC798')+\n  labs(x = 'Northern Anchovy Z',\n       y = str_to_title(str_replace_all(species_name, \"_\", \" \")))+\n  theme_clean()\n\nreturn(list(\n  stage1_summary = sum_m1,\n  stage2_summary = sum_m2,\n  stage1_pred = pred_pres_result,\n  stage2_pred = pred_abu_result,\n  combined_pred = combined,\n  plot = plot\n))\n}\n```\n:::\n\n\n### Function call: Central Bay \n\nThe top indicator for the Central Bay was the Speckled Sanddab so we can call the function for that species and region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled <- predict_indicator(catch_clean, 'SSD', 'CENTRAL BAY')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'species_code', 'catch_info_trawl_id'. You\ncan override using the `.groups` argument.\n```\n\n\n:::\n:::\n\n\nNow `speckled` is encoded with our model summaries, predictions, and plot. For this I will show all outputs, in later chunks I will bypass showing predictions \n\n#### Presence Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$stage1_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = presence ~ northern_anchovy_z * in_region, family = binomial(link = \"logit\"), \n    data = catch_plot)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                      -1.55639    0.03127 -49.769  < 2e-16 ***\nnorthern_anchovy_z               -0.53060    0.08660  -6.127 8.96e-10 ***\nin_regionTRUE                     1.08897    0.08073  13.490  < 2e-16 ***\nnorthern_anchovy_z:in_regionTRUE  0.16045    0.17231   0.931    0.352    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 8776.2  on 8792  degrees of freedom\nResidual deviance: 8543.7  on 8789  degrees of freedom\nAIC: 8551.7\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n:::\n\n#### Abundance Summary \n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$stage2_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = abundance ~ northern_anchovy_z * in_region, \n    data = catch_plot, init.theta = 0.7277030758, link = log)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                       1.96545    0.03315  59.284   <2e-16 ***\nnorthern_anchovy_z               -0.05767    0.05330  -1.082    0.279    \nin_regionTRUE                     0.81587    0.07736  10.546   <2e-16 ***\nnorthern_anchovy_z:in_regionTRUE -0.10104    0.14522  -0.696    0.487    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(0.7277) family taken to be 1)\n\n    Null deviance: 2031.5  on 1749  degrees of freedom\nResidual deviance: 1897.4  on 1746  degrees of freedom\n  (7043 observations deleted due to missingness)\nAIC: 11014\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  0.7277 \n          Std. Err.:  0.0237 \n\n 2 x log-likelihood:  -11004.1330 \n```\n\n\n:::\n:::\n\n#### Presence Prediction\n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$stage1_pred \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 58 × 7\n   in_region northern_anchovy_z fit_link     se pred_tbs   lower upper\n   <lgl>                  <dbl>    <dbl>  <dbl>    <dbl>   <dbl> <dbl>\n 1 TRUE                  -0.273   -0.367 0.0830   0.409  0.371   0.449\n 2 TRUE                   0.727   -0.737 0.134    0.324  0.269   0.384\n 3 TRUE                   1.73    -1.11  0.271    0.248  0.163   0.360\n 4 TRUE                   2.73    -1.48  0.417    0.186  0.0917  0.341\n 5 TRUE                   3.73    -1.85  0.564    0.136  0.0496  0.323\n 6 TRUE                   4.73    -2.22  0.712    0.0982 0.0263  0.305\n 7 TRUE                   5.73    -2.59  0.860    0.0700 0.0137  0.289\n 8 TRUE                   6.73    -2.96  1.01     0.0494 0.00714 0.273\n 9 TRUE                   7.73    -3.33  1.16     0.0346 0.00370 0.257\n10 TRUE                   8.73    -3.70  1.31     0.0242 0.00191 0.243\n# ℹ 48 more rows\n```\n\n\n:::\n:::\n\n\n#### Abundance Prediction \n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$stage2_pred\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 58 × 7\n   in_region northern_anchovy_z fit_link     se pred_tbs  lower upper\n   <lgl>                  <dbl>    <dbl>  <dbl>    <dbl>  <dbl> <dbl>\n 1 TRUE                  -0.273     2.82 0.0756    16.9  14.5    19.5\n 2 TRUE                   0.727     2.67 0.126     14.4  11.2    18.4\n 3 TRUE                   1.73      2.51 0.250     12.3   7.51   20.0\n 4 TRUE                   2.73      2.35 0.382     10.5   4.95   22.1\n 5 TRUE                   3.73      2.19 0.515      8.93  3.25   24.5\n 6 TRUE                   4.73      2.03 0.649      7.62  2.13   27.2\n 7 TRUE                   5.73      1.87 0.784      6.50  1.40   30.2\n 8 TRUE                   6.73      1.71 0.919      5.55  0.917  33.6\n 9 TRUE                   7.73      1.55 1.05       4.73  0.601  37.3\n10 TRUE                   8.73      1.40 1.19       4.04  0.394  41.5\n# ℹ 48 more rows\n```\n\n\n:::\n:::\n\n#### Combined Prediction\n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$combined_pred\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 58 × 10\n   in_region northern_anchovy_z fit_link     se pred_tbs   lower upper\n   <lgl>                  <dbl>    <dbl>  <dbl>    <dbl>   <dbl> <dbl>\n 1 TRUE                  -0.273   -0.367 0.0830   0.409  0.371   0.449\n 2 TRUE                   0.727   -0.737 0.134    0.324  0.269   0.384\n 3 TRUE                   1.73    -1.11  0.271    0.248  0.163   0.360\n 4 TRUE                   2.73    -1.48  0.417    0.186  0.0917  0.341\n 5 TRUE                   3.73    -1.85  0.564    0.136  0.0496  0.323\n 6 TRUE                   4.73    -2.22  0.712    0.0982 0.0263  0.305\n 7 TRUE                   5.73    -2.59  0.860    0.0700 0.0137  0.289\n 8 TRUE                   6.73    -2.96  1.01     0.0494 0.00714 0.273\n 9 TRUE                   7.73    -3.33  1.16     0.0346 0.00370 0.257\n10 TRUE                   8.73    -3.70  1.31     0.0242 0.00191 0.243\n# ℹ 48 more rows\n# ℹ 3 more variables: expected_count <dbl>, lower_expected <dbl>,\n#   upper_expected <dbl>\n```\n\n\n:::\n:::\n\n#### Speckled plot\n\n::: {.cell}\n\n```{.r .cell-code}\nspeckled$plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n#### Discussion: Speckled Sanddab\ntktktktktktkttktkktktktktktktktktktk\n\n\n### Function call: San Pablo Bay\n\n::: {.cell}\n\n```{.r .cell-code}\nbat_ray <- predict_indicator(catch_clean, 'BR', 'SAN PABLO BAY')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'species_code', 'catch_info_trawl_id'. You\ncan override using the `.groups` argument.\n```\n\n\n:::\n:::\n\n\n#### Presence Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nbat_ray$stage1_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = presence ~ northern_anchovy_z * in_region, family = binomial(link = \"logit\"), \n    data = catch_plot)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                       2.59814    0.04346  59.788   <2e-16 ***\nnorthern_anchovy_z               -0.80069    0.03360 -23.834   <2e-16 ***\nin_regionTRUE                    -1.98003    0.95992  -2.063   0.0391 *  \nnorthern_anchovy_z:in_regionTRUE  1.47628    0.93201   1.584   0.1132    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 5211.7  on 8950  degrees of freedom\nResidual deviance: 4483.0  on 8947  degrees of freedom\nAIC: 4491\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n#### Abundance Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nbat_ray$stage2_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = abundance ~ northern_anchovy_z * in_region, \n    data = catch_plot, init.theta = 0.3735027981, link = log)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                       4.32149    0.01831 236.057   <2e-16 ***\nnorthern_anchovy_z               -0.22317    0.02185 -10.216   <2e-16 ***\nin_regionTRUE                    -3.40921    0.91663  -3.719   0.0002 ***\nnorthern_anchovy_z:in_regionTRUE  0.27641    0.46145   0.599   0.5492    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(0.3735) family taken to be 1)\n\n    Null deviance: 10569  on 8188  degrees of freedom\nResidual deviance: 10476  on 8185  degrees of freedom\n  (762 observations deleted due to missingness)\nAIC: 80013\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  0.37350 \n          Std. Err.:  0.00480 \n\n 2 x log-likelihood:  -80002.80600 \n```\n\n\n:::\n:::\n\n#### Bat Ray Plot \n\n::: {.cell}\n\n```{.r .cell-code}\nbat_ray$plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n#### Discussion: Bat Ray \ntktktktktktktkktktktktktktktktkt\n\n### Function Call: South Bay \n\n::: {.cell}\n\n```{.r .cell-code}\nca_tonguefish <- predict_indicator(catch_clean, 'CT', 'SOUTH BAY')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'species_code', 'catch_info_trawl_id'. You\ncan override using the `.groups` argument.\n```\n\n\n:::\n:::\n\n#### Presence Summary \n\n::: {.cell}\n\n```{.r .cell-code}\nca_tonguefish$stage1_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = presence ~ northern_anchovy_z * in_region, family = binomial(link = \"logit\"), \n    data = catch_plot)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                        4.6548     1.0872   4.281 1.86e-05 ***\nnorthern_anchovy_z               -16.4148     3.8546  -4.258 2.06e-05 ***\nin_regionTRUE                     -0.9482     1.0898  -0.870    0.384    \nnorthern_anchovy_z:in_regionTRUE  16.2278     3.8548   4.210 2.56e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1852.3  on 8383  degrees of freedom\nResidual deviance: 1774.7  on 8380  degrees of freedom\nAIC: 1782.7\n\nNumber of Fisher Scoring iterations: 9\n```\n\n\n:::\n:::\n\n#### Abundance Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nca_tonguefish$stage2_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = abundance ~ northern_anchovy_z * in_region, \n    data = catch_plot, init.theta = 0.3724877985, link = log)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                        3.8710     0.3475  11.140   <2e-16 ***\nnorthern_anchovy_z                -3.8196     1.9846  -1.925   0.0543 .  \nin_regionTRUE                      0.4629     0.3480   1.330   0.1834    \nnorthern_anchovy_z:in_regionTRUE   3.6892     1.9847   1.859   0.0631 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(0.3725) family taken to be 1)\n\n    Null deviance: 10540  on 8188  degrees of freedom\nResidual deviance: 10483  on 8185  degrees of freedom\n  (195 observations deleted due to missingness)\nAIC: 80048\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  0.37249 \n          Std. Err.:  0.00478 \n\n 2 x log-likelihood:  -80037.67300 \n```\n\n\n:::\n:::\n\n#### Tonguefish Plot\n\n::: {.cell}\n\n```{.r .cell-code}\nca_tonguefish$plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n#### Discussion: California Tonguefish\ntktktktktk\n\n### Function Call: Suisun Bay \n\n::: {.cell}\n\n```{.r .cell-code}\nbass <- predict_indicator(catch_clean, 'SB', 'SUISUN BAY')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'species_code', 'catch_info_trawl_id'. You\ncan override using the `.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in predict.lm(object, newdata, se.fit, scale = residual.scale, type =\nif (type == : prediction from rank-deficient fit; attr(*, \"non-estim\") has\ndoubtful cases\n```\n\n\n:::\n:::\n\n\n#### Presence Summary \n\n::: {.cell}\n\n```{.r .cell-code}\nbass$stage1_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = presence ~ northern_anchovy_z * in_region, family = binomial(link = \"logit\"), \n    data = catch_plot)\n\nCoefficients:\n                                   Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                      -3.647e+00  1.208e-01 -30.195  < 2e-16 ***\nnorthern_anchovy_z               -2.844e+00  4.959e-01  -5.735 9.76e-09 ***\nin_regionTRUE                    -2.500e+03  1.834e+05  -0.014    0.989    \nnorthern_anchovy_z:in_regionTRUE -9.033e+03  6.577e+05  -0.014    0.989    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3454.3  on 8422  degrees of freedom\nResidual deviance: 2756.5  on 8419  degrees of freedom\nAIC: 2764.5\n\nNumber of Fisher Scoring iterations: 15\n```\n\n\n:::\n:::\n\n#### Abundance Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nbass$stage2_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = abundance ~ northern_anchovy_z * in_region, \n    data = catch_plot, init.theta = 3.09286128, link = log)\n\nCoefficients: (1 not defined because of singularities)\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                       0.33019    0.09293   3.553 0.000381 ***\nnorthern_anchovy_z               -0.52114    0.33331  -1.563 0.117935    \nin_regionTRUE                     1.41003    0.08870  15.896  < 2e-16 ***\nnorthern_anchovy_z:in_regionTRUE       NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(3.0929) family taken to be 1)\n\n    Null deviance: 618.93  on 439  degrees of freedom\nResidual deviance: 324.65  on 437  degrees of freedom\n  (7983 observations deleted due to missingness)\nAIC: 1658.2\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  3.093 \n          Std. Err.:  0.380 \n\n 2 x log-likelihood:  -1650.219 \n```\n\n\n:::\n:::\n\n#### Bass Plot\n\n::: {.cell}\n\n```{.r .cell-code}\nbass$plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n#### Discussion: Striped Bass \ntktktktktk\n\n### Simulate data\ntktkttktktktk\n\n### Final Discussion \ntktktktktktktk\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}